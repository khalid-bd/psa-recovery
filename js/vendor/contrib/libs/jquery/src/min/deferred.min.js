jQuery.extend({Deferred:function(e){var r=[["resolve","done",jQuery.Callbacks("once memory"),"resolved"],["reject","fail",jQuery.Callbacks("once memory"),"rejected"],["notify","progress",jQuery.Callbacks("memory")]],n="pending",t={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return jQuery.Deferred(function(n){jQuery.each(r,function(r,o){var s=o[0],u=jQuery.isFunction(e[r])&&e[r];i[o[1]](function(){var e=u&&u.apply(this,arguments);e&&jQuery.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[s+"With"](this===t?n.promise():this,u?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?jQuery.extend(e,t):t}},i={};return t.pipe=t.then,jQuery.each(r,function(e,o){var s=o[2],u=o[3];t[o[1]]=s.add,u&&s.add(function(){n=u},r[1^e][2].disable,r[2][2].lock),i[o[0]]=function(){return i[o[0]+"With"](this===i?t:this,arguments),this},i[o[0]+"With"]=s.fireWith}),t.promise(i),e&&e.call(i,i),i},when:function(e){var r,n,t,i=0,o=core_slice.call(arguments),s=o.length,u=1!==s||e&&jQuery.isFunction(e.promise)?s:0,a=1===u?e:jQuery.Deferred(),c=function(e,n,t){return function(i){n[e]=this,t[e]=arguments.length>1?core_slice.call(arguments):i,t===r?a.notifyWith(n,t):--u||a.resolveWith(n,t)}};if(s>1)for(r=new Array(s),n=new Array(s),t=new Array(s);s>i;i++)o[i]&&jQuery.isFunction(o[i].promise)?o[i].promise().done(c(i,t,o)).fail(a.reject).progress(c(i,n,r)):--u;return u||a.resolveWith(t,o),a.promise()}});